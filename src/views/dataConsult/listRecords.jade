if (utils.empty(more_results))
	table(class="table table-striped list-records list-records-js" data-page="1")
		thead
			tr
				for field in fields
					th #{field}
		tbody
			for row in records
				tr
					for field in fields
						block flag
							- var flag = false;
						each value, key in row
							if key == field
								block flag_
									- flag = true;
								td #{value}
						if flag == false
							td
else
	for row in records
		tr
			for field in fields
				block flag
					- var flag = false;
				each value, key in row
					if key == field
						block flag_
							- flag = true;
						td #{value}
				if flag == false
					td

div.animation-image(align='center')
	img(src='/img/loading-bar.gif')

script.
	$(function(){
		$('.operation-opts-js .separator-js').show();
		$('.operation-opts-js .download-csv-js').show();
		$('.operation-opts-js .download-js').show();

		$(document).ready(function() {
			var loading  	= false; //to prevents multipal ajax loads
			var site_url 	= $('#site-url').data('site_url');
			var element 	= $('.main-container .content .list-records-js');
			var page 		= element.data('page');

			$(window).scroll(function() { //detect page scroll
				if($(window).scrollTop() + $(window).height() == $(document).height()) { //user scrolled to bottom of the page?
					if(loading==false) { //there's more data to load
						loading = true; //prevent further ajax loading
						$('.animation-image').show(); //show loading image
						var data 	= serializeSearchDatasetForm();
						data.page 	= page;
						element.data('page', ++page);
						$.ajax({
							type: 'POST',
							contentType: "application/json; charset=utf-8",
							data: JSON.stringify(data),
							url: site_url+'/datasetExplorer/searchDatasetData',
							global: false,
							success: function(response){
								$('.main-container .content .list-records-js tbody').append(response);
								$('.animation-image').hide(); //hide loading image
							}
						});
					}
				}
			});
		});
	});
